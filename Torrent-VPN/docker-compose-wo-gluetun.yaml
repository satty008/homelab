# docker-compose-wo-gluetun.yaml
# Gluetun-less ARR + Jellyfin stack. Services join an external 'proxy' network for Traefik.

services:
  sabnzbd:
    image: lscr.io/linuxserver/sabnzbd:latest
    container_name: sabnzbd
    ports:
      - "8080:8080"
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Asia/Kolkata
    volumes:
      - /home/ubuntu/docker/arr-stack/sabnzbd:/config
      - /home/ubuntu/docker/arr-stack/downloads:/downloads
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.sabnzbd.entrypoints=http"
      - "traefik.http.routers.sabnzbd.rule=Host(`sabnzbd.commitandpray.duckdns.org`)"
      - "traefik.http.routers.sabnzbd.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.sabnzbd-secure.entrypoints=https"
      - "traefik.http.routers.sabnzbd-secure.rule=Host(`sabnzbd.commitandpray.duckdns.org`)"
      - "traefik.http.routers.sabnzbd-secure.tls=true"
      - "traefik.http.routers.sabnzbd-secure.service=sabnzbd"
      - "traefik.http.services.sabnzbd.loadbalancer.server.port=8080"
      - "traefik.docker.network=proxy"

  jackett:
    image: lscr.io/linuxserver/jackett:latest
    container_name: jackett
    ports:
      - "9117:9117"
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Asia/Kolkata
      AUTO_UPDATE: "true"
    volumes:
      - /home/ubuntu/docker/arr-stack/jackett/data:/config
      - /home/ubuntu/docker/arr-stack/jackett/blackhole:/downloads
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.jackett.entrypoints=http"
      - "traefik.http.routers.jackett.rule=Host(`jackett.commitandpray.duckdns.org`)"
      - "traefik.http.routers.jackett.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.jackett-secure.entrypoints=https"
      - "traefik.http.routers.jackett-secure.rule=Host(`jackett.commitandpray.duckdns.org`)"
      - "traefik.http.routers.jackett-secure.tls=true"
      - "traefik.http.routers.jackett-secure.service=jackett"
      - "traefik.http.services.jackett.loadbalancer.server.port=9117"
      - "traefik.docker.network=proxy"

  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    ports:
      - "8989:8989"
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Asia/Kolkata
    volumes:
      - /home/ubuntu/docker/arr-stack/sonarr/data:/config
      - /home/ubuntu/docker/arr-stack/sonarr/tvseries:/tv
      - /home/ubuntu/docker/arr-stack/sonarr/downloadclient-downloads:/downloads
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.sonarr.entrypoints=http"
      - "traefik.http.routers.sonarr.rule=Host(`sonarr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.sonarr.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.sonarr-secure.entrypoints=https"
      - "traefik.http.routers.sonarr-secure.rule=Host(`sonarr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.sonarr-secure.tls=true"
      - "traefik.http.routers.sonarr-secure.service=sonarr"
      - "traefik.http.services.sonarr.loadbalancer.server.port=8989"
      - "traefik.docker.network=proxy"

  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    ports:
      - "7878:7878"
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Asia/Kolkata
    volumes:
      - /home/ubuntu/docker/arr-stack/radarr/data:/config
      - /home/ubuntu/docker/arr-stack/qbittorrent/downloads:/downloads
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.radarr.entrypoints=http"
      - "traefik.http.routers.radarr.rule=Host(`radarr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.radarr.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.radarr-secure.entrypoints=https"
      - "traefik.http.routers.radarr-secure.rule=Host(`radarr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.radarr-secure.tls=true"
      - "traefik.http.routers.radarr-secure.service=radarr"
      - "traefik.http.services.radarr.loadbalancer.server.port=7878"
      - "traefik.docker.network=proxy"

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    ports:
      - "9696:9696"
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Asia/Kolkata
    volumes:
      - /home/ubuntu/docker/arr-stack/prowlarr/data:/config
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.prowlarr.entrypoints=http"
      - "traefik.http.routers.prowlarr.rule=Host(`prowlarr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.prowlarr.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.prowlarr-secure.entrypoints=https"
      - "traefik.http.routers.prowlarr-secure.rule=Host(`prowlarr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.prowlarr-secure.tls=true"
      - "traefik.http.routers.prowlarr-secure.service=prowlarr"
      - "traefik.http.services.prowlarr.loadbalancer.server.port=9696"
      - "traefik.docker.network=proxy"

  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    container_name: homepage
    environment:
      PUID: 1000
      PGID: 1000
      HOMEPAGE_ALLOWED_HOSTS: homepage-arr.commitandpray.duckdns.org
      TZ: Asia/Kolkata
    volumes:
      - /home/ubuntu/docker/arr-stack/homepage:/app/config
      - /var/run/docker.sock:/var/run/docker.sock:ro
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.homepage-arr.entrypoints=http"
      - "traefik.http.routers.homepage-arr.rule=Host(`homepage-arr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.homepage-arr.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.homepage-arr-secure.entrypoints=https"
      - "traefik.http.routers.homepage-arr-secure.rule=Host(`homepage-arr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.homepage-arr-secure.tls=true"
      - "traefik.http.routers.homepage-arr-secure.service=homepage-arr"
      - "traefik.http.services.homepage-arr.loadbalancer.server.port=3000"
      - "traefik.docker.network=proxy"

  jellyfin:
    image: jellyfin/jellyfin:latest
    container_name: jellyfin
    environment:
      TZ: Asia/Kolkata
    volumes:
      - /home/ubuntu/docker/arr-stack/jellyfin/config:/config
      - /home/ubuntu/docker/arr-stack/jellyfin/cache:/cache
      - /home/ubuntu/media:/media
    restart: unless-stopped
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.jellyfin-arr.entrypoints=http"
      - "traefik.http.routers.jellyfin-arr.rule=Host(`jellyfin-arr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.jellyfin-arr.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.jellyfin-arr-secure.entrypoints=https"
      - "traefik.http.routers.jellyfin-arr-secure.rule=Host(`jellyfin-arr.commitandpray.duckdns.org`)"
      - "traefik.http.routers.jellyfin-arr-secure.tls=true"
      - "traefik.http.routers.jellyfin-arr-secure.service=jellyfin-arr"
      - "traefik.http.services.jellyfin-arr.loadbalancer.server.port=8096"
      - "traefik.docker.network=proxy"

  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    ports:
      - "6881:6881"
      - "6881:6881/udp"
      - "8085:8085"
    environment:
      PUID: 1000
      PGID: 1000
      TZ: Asia/Kolkata
      WEBUI_PORT: 8085
    volumes:
      - /home/ubuntu/docker/arr-stack/qbittorrent:/config
      - /home/ubuntu/docker/arr-stack/qbittorrent/downloads:/downloads
    restart: always
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.qbittorrent.entrypoints=http"
      - "traefik.http.routers.qbittorrent.rule=Host(`qbittorrent.commitandpray.duckdns.org`)"
      - "traefik.http.routers.qbittorrent.middlewares=default-security-headers@file,https-redirectscheme@file"
      - "traefik.http.routers.qbittorrent-secure.entrypoints=https"
      - "traefik.http.routers.qbittorrent-secure.rule=Host(`qbittorrent.commitandpray.duckdns.org`)"
      - "traefik.http.routers.qbittorrent-secure.tls=true"
      - "traefik.http.routers.qbittorrent-secure.service=qbittorrent"
      - "traefik.http.services.qbittorrent.loadbalancer.server.port=8085"
      - "traefik.docker.network=proxy"

networks:
  proxy:
    external: true
